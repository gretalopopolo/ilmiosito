<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p5.js grid</title>

    <script src="https://cdn.jsdelivr.net/npm/p5@1.5.0/lib/p5.min.js"></script>

    <style>
        body {
            margin: 0;
            background-color: grey;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
    </style>
</head>

<body>

<script>
let faccione;
let imgW, imgH;
let imgOX, imgOY;

function preload() {
    faccione = loadImage("selfie.png");
}

function setup() {
    createCanvas(512, 384);
    colorMode(HSB, 360, 100, 100);

   
    let scale = max(width / faccione.width, height / faccione.height) * 1.2;
    imgW = faccione.width * scale;
    imgH = faccione.height * scale;

    
    imgOX = (width - imgW) / 2;
    imgOY = (height - imgH) / 2 + 60;

    faccione.resize(imgW, imgH);
}

function draw() {
    background(0);
    noStroke();

    let numH = 52;
    let numV = 44;
    let d = 8;

    let ox = (width - (numH - 1) * d) / 2;
    let oy = (height - (numV - 1) * d) / 2 - 10;

    for (let j = 0; j < numV; j++) {
        for (let i = 0; i < numH; i++) {

            let px = ox + i * d;
            let py = oy + j * d;

            
            let wave = sin(frameCount * 0.04 + i * 0.4 + j * 0.4) * 4;

            let wx = px;
            let wy = py + wave;

            
            let dx = wx - mouseX;
            let dy = wy - mouseY;
            let distMouse = sqrt(dx * dx + dy * dy);

            let radius = 600; 
            if (distMouse < radius) {
                let force = map(distMouse, 0, radius, 15, 0);
                wx += (dx / distMouse) * force;
                wy += (dy / distMouse) * force;
            }

            
            let ix = wx - imgOX;
            let iy = wy - imgOY;

            if (ix >= 0 && ix < imgW && iy >= 0 && iy < imgH) {
                let c = faccione.get(ix, iy);

                
                let h = hue(color(c));
                let s = saturation(color(c));
                let b = brightness(color(c));
                b = min(b + 30, 100); 
                fill(h, s, b);

                
                let lum = (red(c) + green(c) + blue(c)) / 3;
                let r = map(lum, 0, 255, 3, 9);

                circle(wx, wy, r);
            }
        }
    }
}
</script>

</body>
</html>
